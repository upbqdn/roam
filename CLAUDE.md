# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with
code in this repository.

## Project overview

Org-roam knowledge base and blog exported to a Hugo static site. Contains
mathematical definitions (algebraic structures) and blog posts. Hosted on GitHub
(`github.com:upbqdn/roam`).

`test-node.org` is a rendering testbed — ignore its contents as reference for
conventions.

## File conventions

- **Filenames:** kebab-case `.org` files
- **IDs:** Every file has a `:PROPERTIES:` block with `:ID:`. Math definitions
    use short keywords (e.g. `ring`, `group`); blog posts use UUIDs.
- **Label IDs:** Items such as definitions, theorems, proofs, lemmas, examples,
    remarks, propositions, algorithms, figures, tables, and videos each get a
    z-base-32 identifier generated by `~/repos/puke` (an Emacs package).
    `id-counter` tracks the next available index. **Critical invariant:** label
    IDs must be unique and contiguous across the entire repo — they are used for
    cross-file referencing.
- **Bibliography:** All citations go in `ref.bib` (BibTeX), referenced via
    `[cite:@key]`, exported with `#+cite_export: csl` and
    `#+print_bibliography:`

## Blog posts vs definition files

**Blog posts** (`#+hugo_tags: blog`): narrative content with media, `#+date:`,
  `#+hugo_lastmod:`, and `#+print_bibliography:` at the end. Body text should
  appear before the first heading — don't wrap the introduction in a heading.

**Math definitions** (e.g. `ring.org`, `group.org`): short files using custom
  blocks for structured content. Tagged with some combination of `math`,
  `definitions`, `algebraic-structures`.

Custom block types and their label prefixes:
- `#+BEGIN_def` — definitions, anchored as `<<.def-X>>`
- `#+BEGIN_rem` — remarks, anchored as `<<.rem-X>>`
- `#+BEGIN_ex` — examples, anchored as `<<.exp-X>>`
- `#+BEGIN_pr` — propositions, anchored as `<<.prp-X>>`

Where `X` is a z-base-32 identifier. Blog posts may also use `.alg-X`
(algorithms) and `.thm-X` anchors outside of custom blocks.

**Self-referencing pattern:** Each anchor is followed by a bold self-link, e.g.:
```
<<.def-g>> *[[.def-g][Definition g]]*. A *ring* is ...
```

**Tables and figures** use the same self-referencing pattern inside
`#+begin_center`:
```
#+begin_center
<<.tab-9>> *[[.tab-9][Table 9]]*. Caption text.
#+end_center
| ... |
```
Do not use `#+caption:` — it triggers Hugo's auto-numbering which conflicts
with the z-base-32 IDs.

**Cross-referencing:** `[[.def-g][Definition g]]` for anchors within the same
file, `[[file:group.org::.def-r][monoid]]` for cross-file references via org-roam.

**Math notation:** prefer `\(...\)` and `\[...\]` over `$...$` and `$$...$$`.

## Media

- Media lives in `data/` with subdirectories per topic (e.g. `data/mining/`,
  `data/evolutionary-algorithms/`)
- Images: `[[file:/data/mining/name.jpg]]`
- Videos: `#+attr_html: :controls t` followed by a `#+begin_video` block:
  ```
  #+attr_html: :controls t
  #+begin_video
  <source src="/data/mining/name.mp4" type="video/mp4">
  #+end_video
  ```
- `data/**/*.mp4` is gitignored; commit images, SVGs, and GIFs but not videos
